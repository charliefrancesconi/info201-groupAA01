color = "rgb(244, 30, 30)",
shadow = FALSE
),
showarrow = FALSE
)
state_plot
state_plot <- plot_ly(
x = ~t_i,
y = ~ reorder(s, t_i + t_k),
type = "bar",
orientation = "h",
name = "total_injured"
) %>%
add_trace(
x = ~t_k,
name = "total_killed"
) %>%
layout(
xaxis = list(title = "Total impacted"),
yaxis = list(title = "State"),
barmode = "stack",
title = "Total numbers of people impacted by the shooting in each state"
) %>%
add_annotations( # add annontations for accessibility
xref = "x",
yref = "y",
x = t_k + t_i + 10,
y = reorder(s, t_i + t_k),
text = paste0(t_i + t_k),
font = list(
family = "Arial",
size = 10,
color = "rgb(244, 30, 30)",
shadow = FALSE
),
showarrow = FALSE
)
state_plot
state_plot <- plot_ly(
x = ~t_i,
y = ~ reorder(s, t_i + t_k),
type = "bar",
orientation = "h",
name = "total_injured"
) %>%
add_trace(
x = ~t_k,
name = "total_killed"
) %>%
layout(
xaxis = list(title = "Total impacted"),
yaxis = list(title = "State"),
barmode = "stack",
title = "Total numbers of people impacted by the shooting in each state"
) %>%
add_annotations( # add annontations for accessibility
xref = "x",
yref = "y",
x = t_k + t_i + 100,
y = reorder(s, t_i + t_k),
text = paste0(t_i + t_k),
font = list(
family = "Arial",
size = 10,
color = "rgb(244, 30, 30)",
shadow = FALSE
),
showarrow = FALSE
)
state_plot
state_plot <- plot_ly(
x = ~t_i,
y = ~ reorder(s, t_i + t_k),
type = "bar",
orientation = "h",
name = "total_injured"
) %>%
add_trace(
x = ~t_k,
name = "total_killed"
) %>%
layout(
xaxis = list(title = "Total impacted"),
yaxis = list(title = "State"),
barmode = "stack",
title = "Total numbers of people impacted by the shooting in each state"
) %>%
add_annotations( # add annontations for accessibility
xref = "x",
yref = "y",
x = t_k + t_i + 1000,
y = reorder(s, t_i + t_k),
text = paste0(t_i + t_k),
font = list(
family = "Arial",
size = 10,
color = "rgb(244, 30, 30)",
shadow = FALSE
),
showarrow = FALSE
)
state_plot
state_plot <- plot_ly(
x = ~t_i,
y = ~ reorder(s, t_i + t_k),
type = "bar",
orientation = "h",
name = "total_injured"
) %>%
add_trace(
x = ~t_k,
name = "total_killed"
) %>%
layout(
xaxis = list(title = "Total impacted"),
yaxis = list(title = "State"),
barmode = "stack",
title = "Total numbers of people impacted by the shooting in each state"
) %>%
add_annotations( # add annontations for accessibility
xref = "x",
yref = "y",
x = t_k + t_i + 500,
y = reorder(s, t_i + t_k),
text = paste0(t_i + t_k),
font = list(
family = "Arial",
size = 10,
color = "rgb(244, 30, 30)",
shadow = FALSE
),
showarrow = FALSE
)
state_plot
state_plot <- plot_ly(
x = ~t_i,
y = ~ reorder(s, t_i + t_k),
type = "bar",
orientation = "h",
name = "total_injured"
) %>%
add_trace(
x = ~t_k,
name = "total_killed"
) %>%
layout(
xaxis = list(title = "Total impacted"),
yaxis = list(title = "State"),
barmode = "stack",
title = "Total numbers of people impacted by the shooting in each state"
) %>%
add_annotations( # add annontations for accessibility
xref = "x",
yref = "y",
x = t_k + t_i + 300,
y = reorder(s, t_i + t_k),
text = paste0(t_i + t_k),
font = list(
family = "Arial",
size = 10,
color = "rgb(244, 30, 30)",
shadow = FALSE
),
showarrow = FALSE
)
state_plot
s_df <- s_df%>%
select(incident_id,date,state, city_or_county, address, n_killed, n_injured, longitude, latitude)
View(s_df)
s_df <- s_df%>%
select(incident_id,date,state, city_or_county, address, n_killed, n_injured, longitude, latitude)
# change n_killed & n_injured to numeric
s_df$n_killed <- as.numeric(s_df$n_killed, na.exclude(s_df$n_killed))
s_df$n_injured <- as.numeric(s_df$n_injured, na.exclude(s_df$n_injured))
# range of year
range_of_year <- seq(2013,2018)
# number of shootings occurred
num_of_shootings <- nrow(s_df)
# total lives lost
num_of_lives_lost <- sum(s_df$n_killed)
# total injured
num_of_injured <- sum(s_df$n_injured)
# city that was most impacted by shootings
# defining 'impact'
city_with_most_shooting <- s_df %>%
group_by(city_or_county) %>%
summarize(occurence = n()) %>%
filter(occurence == max(occurence)) %>%
pull(city_or_county)
# city with most people murdered
city_with_most_killed <- s_df %>%
group_by(city_or_county) %>%
summarize(total_killed = sum(n_killed)) %>%
filter(total_killed == max(total_killed)) %>%
select(city_or_county, total_killed)
# state with most people impacted (both injured and murdered)
state_with_most_impacts <- s_df %>%
group_by(state) %>%
summarize(total_impacts = sum(n_killed) + sum(n_injured)) %>%
filter(total_impacts == max(total_impacts)) %>%
select(state, total_impacts)
# group by state to give state-wise stats
state_stat <- s_df %>%
group_by(state) %>%
summarize(
total_killed = sum(n_killed),
total_injured = sum(n_injured)
) %>%
arrange(- (total_killed + total_injured))
# df that we are interested in
s <- state_stat$state
t_k <- state_stat$total_killed
t_i <- state_stat$total_injured
# A bar chart
state_plot <- plot_ly(
x = ~t_i,
y = ~ reorder(s, t_i + t_k),
type = "bar",
orientation = "h",
name = "total_injured"
) %>%
add_trace(
x = ~t_k,
name = "total_killed"
) %>%
layout(
xaxis = list(title = "Total impacted"),
yaxis = list(title = "State"),
barmode = "stack",
title = "Total numbers of people impacted by the shooting in each state"
) %>%
add_annotations( # add annontations for accessibility
xref = "x",
yref = "y",
x = t_k + t_i + 300,
y = reorder(s, t_i + t_k),
text = paste0(t_i + t_k),
font = list(
family = "Arial",
size = 10,
color = "rgb(244, 30, 30)",
shadow = FALSE
),
showarrow = FALSE
)
state_plot
s_df <- read.csv(file = "data/gun-violence-data_01-2013_03-2018.csv",header = TRUE, stringsAsFactors = FALSE)
View(s_df)
s_df <- read.csv(file = "data/gun-violence-data_01-2013_03-2018.csv",header = TRUE, stringsAsFactors = FALSE)
library(dplyr)
library(plotly)
library(stringr)
library(ggplot2)
library(gganimate)
library(babynames)
library(hrbrthemes)
s_df <- s_df%>%
select(incident_id,date,state, city_or_county, address, n_killed, n_injured, longitude, latitude)
state_with_most_impacts <- s_df %>%
group_by(state) %>%
summarize(total_impacts = sum(n_killed) + sum(n_injured)) %>%
filter(total_impacts == max(total_impacts)) %>%
select(state, total_impacts)
View(s_df)
install.packages("gganimate")
install.packages("hrbrthemes")
s_df <- read.csv(file = "data/gun-violence-data_01-2013_03-2018.csv",header = TRUE, stringsAsFactors = FALSE)
library(stringr)
library(plotly)
library(dplyr)
library(ggplot2)
library(gganimate)
library(hrbrthemes)
s_df <- s_df%>%
select(incident_id,date,state, city_or_county, address, n_killed, n_injured, longitude, latitude)
s_df$n_killed <- as.numeric(s_df$n_killed, na.exclude(s_df$n_killed))
s_df$n_injured <- as.numeric(s_df$n_injured, na.exclude(s_df$n_injured))
range_of_year <- seq(2013,2018)
state_with_most_impacts <- s_df %>%
group_by(state) %>%
summarize(total_impacts = sum(n_killed) + sum(n_injured)) %>%
filter(total_impacts == max(total_impacts)) %>%
select(state, total_impacts)
n_killed_n_injured <- state_with_most_impacts%>%
filter(n_killed, n_injured)
n_killed_n_injured <- state_with_most_impacts%>%
filter(most_impacted %in% c("n_killed", "n_injured"))
n_killed_n_injured <- state_with_most_impacts%>%
filter(total_impacts %in% c("n_killed", "n_injured"))
View(n_killed_n_injured)
View(state_with_most_impacts)
View(state_with_most_impacts)
state_with_most_impacts <- s_df %>%
group_by(state) %>%
summarize(total_impacts = sum(n_killed) + sum(n_injured)) %>%
select(state, total_impacts)
n_killed_n_injured <- state_with_most_impacts%>%
filter(total_impacts %in% c("n_killed", "n_injured"))
View(n_killed_n_injured)
View(state_with_most_impacts)
state_impacts <- s_df %>%
group_by(state) %>%
summarize(total_impacts = sum(n_killed) + sum(n_injured)) %>%
select(state, total_impacts)
n_killed_n_injured <- state_impacts%>%
filter(total_impacts = c("n_killed", "n_injured"))
s_df <- read.csv(file = "data/gun-violence-data_01-2013_03-2018.csv",header = TRUE, stringsAsFactors = FALSE)
state_impacts <- s_df %>%
group_by(state) %>%
summarize(total_impacts = sum(n_killed) + sum(n_injured)) %>%
select(state, total_impacts)
n_killed_n_injured <- state_impacts%>%
filter(total_impacts %in% c("n_killed", "n_injured"))
install.packages("babynames")
library(ggplot2)
library(gganimate)
library(babynames)
library(hrbrthemes)
# Keep only 3 names
don <- babynames %>%
filter(name %in% c("Ashley", "Patricia", "Helen")) %>%
filter(sex=="F")
View(don)
View(state_impacts)
n_killed_n_injured <- state_impacts%>%
filter("n_killed", "n_injured")
n_killed_n_injured <- state_impacts%>%
filter(n_killed, n_injured)
n_killed_n_injured <- s_df%>%
filter(n_killed, n_injured)
View(n_killed_n_injured)
n_killed_n_injured <- s_df%>%
filter(n_killed, n_injured)
n_killed_n_injured <- s_df%>%
select(n_killed, n_injured)
View(n_killed_n_injured)
View(s_df)
n_killed_n_injured <- s_df%>%
mutate(year = format(as.Date(
substr(s_df$date, 1, 4)
), "%A")) %>%
select(n_killed, n_injured)
n_killed_n_injured <- s_df%>%
mutate(year = as.numeric(substr(s_df$date, 1, 4))) %>%
select(n_killed, n_injured)
View(n_killed_n_injured)
n_killed_n_injured <- s_df%>%
mutate(year = as.numeric(substr(s_df$date, 1, 4))) %>%
select(year, n_killed, n_injured)
n_killed_n_injured <- s_df%>%
mutate(year = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year)%>%
select(year, n_killed, n_injured)
View(n_killed_n_injured)
n_killed_n_injured <- s_df%>%
mutate(year = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year)
n_killed_n_injured <- s_df%>%
mutate(year = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year)%>%
summarize(total_num = sum(n_injured))
n_killed_n_injured <- s_df%>%
mutate(year = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year)%>%
summarize(injured_num = sum(n_injured), killed_num = sum(n_killed))
library(tidyr)
tidy_num <- gather(n_killed_n_injured, key = "n_injured", value = "n_killed")
View(tidy_num)
tidy_num <- gather(n_killed_n_injured, key = "year", value = "n_killed")
n_killed_n_injured <- s_df%>%
mutate(year1 = as.numeric(substr(s_df$date, 1, 4))) %>%
mutate(year2 = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year1)%>%
summarize(injured_num = sum(n_injured), killed_num = sum(n_killed))
tidy_num <- gather(n_killed_n_injured, key = "year1", value = "n_killed")
n_killed_n_injured <- s_df%>%
mutate(year1 = as.numeric(substr(s_df$date, 1, 4))) %>%
mutate(year2 = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year1)%>%
summarize(injured_num = sum(n_injured), killed_num = sum(n_killed))
n_killed_n_injured <- s_df%>%
mutate(year1 = as.numeric(substr(s_df$date, 1, 4))) %>%
mutate(year2 = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year1, year2)%>%
summarize(injured_num = sum(n_injured), killed_num = sum(n_killed))
tidy_num <- gather(n_killed_n_injured, key = "year1", value = "n_killed")
tidy_num <- gather(n_killed_n_injured, key = "year", value = "n_killed", "n_injured")
tidy_num <- gather(n_killed_n_injured, key = "year", value = c("n_killed","n_injured"))
tidy_num <- gather(n_killed_n_injured, key = "year", value = "n_injured")
state_impacts <- s_df %>%
group_by(state) %>%
summarize(total_impacts = sum(n_killed) + sum(n_injured)) %>%
select(state, total_impacts)
n_killed_n_injured <- s_df%>%
mutate(year = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year)%>%
summarize(injured_num = sum(n_injured), killed_num = sum(n_killed))
tidy_num <- gather(n_killed_n_injured, key = "year", value = "n_injured")
tidy_num <- s_df%>%
gather(n_killed_n_injured, key = "year", value = "n_injured")
tidy_num <- n_killed_n_injured%>%
gather(key = "year", value = "n_injured")
n_killed_n_injured <- s_df%>%
mutate(year_value = as.numeric(substr(s_df$date, 1, 4))) %>%
mutate(year = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year_value, year)%>%
summarize(injured_num = sum(n_injured), killed_num = sum(n_killed))
tidy_num <- n_killed_n_injured%>%
gather(key = "year_value", value = "n_injured")
state_plot <- plotly(
x = ~t_i,
y = ~ reorder(s, t_i + t_k),
type = "bar",
orientation = "h",
name = "total_injured"
) %>%
add_trace(
x = ~t_k,
name = "total_killed"
) %>%
layout(
xaxis = list(title = "Total impacted"),
yaxis = list(title = "State"),
barmode = "stack",
title = "Total numbers of people impacted by the shooting in each state"
) %>%
add_annotations( # add annontations for accessibility
xref = "x",
yref = "y",
x = t_k + t_i + 300,
y = reorder(s, t_i + t_k),
text = paste0(t_i + t_k),
font = list(
family = "Arial",
size = 10,
color = "rgb(244, 30, 30)",
shadow = FALSE
),
showarrow = FALSE
)
state_plot <- plot_ly(
x = ~t_i,
y = ~ reorder(s, t_i + t_k),
type = "bar",
orientation = "h",
name = "total_injured"
) %>%
add_trace(
x = ~t_k,
name = "total_killed"
) %>%
layout(
xaxis = list(title = "Total impacted"),
yaxis = list(title = "State"),
barmode = "stack",
title = "Total numbers of people impacted by the shooting in each state"
) %>%
add_annotations( # add annontations for accessibility
xref = "x",
yref = "y",
x = t_k + t_i + 300,
y = reorder(s, t_i + t_k),
text = paste0(t_i + t_k),
font = list(
family = "Arial",
size = 10,
color = "rgb(244, 30, 30)",
shadow = FALSE
),
showarrow = FALSE
)
n_killed_n_injured <- s_df%>%
mutate(year = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year_value, year)%>%
summarize(injured_num = sum(n_injured), killed_num = sum(n_killed))
tidy_num <- n_killed_n_injured%>%
gather(key = "year_value", value = "n_injured")
n_killed_n_injured <- s_df%>%
mutate(year = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year)%>%
summarize(injured_num = sum(n_injured), killed_num = sum(n_killed))
tidy_num <- n_killed_n_injured%>%
gather(key = "year_value", value = "n_injured")
tidy_num <- n_killed_n_injured%>%
gather(year, num)
n_killed_n_injured <- s_df%>%
mutate(year = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year)%>%
summarize(injured_num = sum(n_injured), killed_num = sum(n_killed))%>%
select(incident_id, year, n_injured, n_killed)
n_killed_n_injured <- s_df%>%
mutate(year = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year)%>%
summarize(injured_num = sum(n_injured), killed_num = sum(n_killed))%>%
mutate(id = incident_id)
n_killed_n_injured <- s_df%>%
mutate(year = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year)%>%
summarize(injured_num = sum(n_injured), killed_num = sum(n_killed))%>%
mutate(id = s_df$incident_id)
n_killed_n_injured <- s_df%>%
mutate(year = as.numeric(substr(s_df$date, 1, 4))) %>%
group_by(year)%>%
summarize(injured_num = sum(n_injured), killed_num = sum(n_killed))
install.packages("shiny")
# load shiny library
library("shiny")
setwd("~/Documents/WORKS/OneDrive - UW/INFO201/info201-groupAA01-getting-the-facts-on-gun-violence-in-the-united-states")
source("app_ui.R")
source("app_server.R")
# host shiny app
shinyApp(ui = ui, server = server)
